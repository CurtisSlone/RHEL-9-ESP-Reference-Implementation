# /etc/sudoers
# This file MUST be edited with the 'visudo' command as root.
# See the man page for details on how to write a sudoers file.

Defaults        env_reset
Defaults        mail_badpass
Defaults        secure_path="/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
Defaults        logfile="/var/log/sudo.log"
Defaults        log_input,log_output
Defaults        iolog_dir="/var/log/sudo-io"
Defaults        timestamp_timeout=15
Defaults        passwd_tries=3
Defaults        badpass_message="Authentication failure - contact system administrator"

# Host alias specification
Host_Alias      SERVERS = 192.168.1.0/24, server1, server2
Host_Alias      WORKSTATIONS = 192.168.2.0/24

# User alias specification
User_Alias      ADMINS = john, jane, bob
User_Alias      OPERATORS = alice, charlie
User_Alias      DEVELOPERS = dev1, dev2, dev3

# Cmnd alias specification
Cmnd_Alias      SERVICES = /bin/systemctl, /usr/bin/service, /sbin/service
Cmnd_Alias      NETWORKING = /sbin/route, /sbin/ifconfig, /bin/ping, /usr/bin/netstat
Cmnd_Alias      SOFTWARE = /usr/bin/yum, /usr/bin/apt-get, /usr/bin/apt, /usr/bin/dpkg
Cmnd_Alias      PROCESSES = /bin/kill, /usr/bin/killall, /bin/ps
Cmnd_Alias      STORAGE = /sbin/fdisk, /sbin/parted, /bin/mount, /bin/umount

# User privilege specification
root    ALL=(ALL:ALL) ALL
%admin  ALL=(ALL) ALL
%sudo   ALL=(ALL:ALL) ALL

# Allow ADMINS to run any command
ADMINS  ALL=(ALL) NOPASSWD: ALL

# Allow OPERATORS to manage services without password
OPERATORS ALL=(ALL) NOPASSWD: SERVICES, NETWORKING, PROCESSES

# Allow DEVELOPERS limited access
DEVELOPERS WORKSTATIONS=(ALL) NOPASSWD: SOFTWARE, /usr/bin/git, /usr/bin/docker

# Specific user restrictions
jane    ALL=(ALL) ALL, !SOFTWARE, !/bin/su
bob     SERVERS=(root) NOPASSWD: /usr/bin/systemctl restart apache2

# Allow wheel group members to run commands
%wheel  ALL=(ALL) ALL

# Disable root login requirements for specific commands
ALL     ALL=(ALL) NOPASSWD: /bin/mount /mnt/cdrom, /bin/umount /mnt/cdrom